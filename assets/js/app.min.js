const CONFIG={animationDuration:300,scrollThreshold:.1,particleCount:50,enableHapticFeedback:!0,loadingDuration:2e3};class ModernApp{constructor(){console.log("🚀 Iniciando ModernApp..."),this.init()}init(){console.log("⚙️ Executando init()..."),this.initThemeToggle(),this.createParticleBackground(),this.initInteractiveElements(),this.setupLoadingScreen(),this.setupEventListeners(),this.initializeAnimations(),this.setupHapticFeedback(),this.initializePWA(),console.log("✅ init() concluído!")}initThemeToggle(){const e=document.getElementById("themeToggle"),t=document.body,n=localStorage.getItem("theme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;t.className=n||(a?"dark-mode":"light-mode"),e.addEventListener("click",()=>{const n="light-mode"===t.className?"dark-mode":"light-mode";t.className=n,localStorage.setItem("theme",n),e.style.transform="scale(1.2) rotate(180deg)",setTimeout(()=>{e.style.transform=""},300),e.blur()}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")||(t.className=e.matches?"dark-mode":"light-mode")})}setupLoadingScreen(){console.log("🔍 Iniciando setupLoadingScreen...");const e=document.getElementById("loading-screen");console.log("📱 Elemento loading-screen encontrado:",e),e?(console.log("⏱️ Configurando timer de loading..."),setTimeout(()=>{console.log("✅ Adicionando classe hidden..."),e.classList.add("hidden"),setTimeout(()=>{console.log("🗑️ Removendo loading screen..."),e.remove()},500)},CONFIG.loadingDuration)):console.error("❌ Elemento loading-screen não encontrado!")}setupEventListeners(){const e=document.getElementById("emergency-btn"),t=document.getElementById("emergency-contacts"),n=document.querySelector(".toggle-icon");e&&t&&e.addEventListener("click",a=>{a.preventDefault(),this.toggleEmergencyContacts(e,t,n)});document.querySelectorAll(".app-link").forEach(e=>{this.setupLinkEffects(e)});const a=document.querySelector(".tutorial-btn");a&&(a.addEventListener("mouseenter",()=>{this.add3DEffect(a)}),a.addEventListener("mouseleave",()=>{this.remove3DEffect(a)}),a.addEventListener("click",e=>{this.createRippleEffect(e,a),this.triggerHapticFeedback()}));document.querySelectorAll(".social-icon").forEach(e=>{this.setupSocialIconEffects(e)}),document.addEventListener("gesturestart",e=>e.preventDefault()),document.addEventListener("gesturechange",e=>e.preventDefault()),document.addEventListener("gestureend",e=>e.preventDefault()),this.setupAccessibility()}setupAccessibility(){document.addEventListener("keydown",e=>{if("Escape"===e.key){const e=document.getElementById("emergency-contacts");if(e&&!e.classList.contains("hidden")){const t=document.getElementById("emergency-btn"),n=document.querySelector(".toggle-icon");this.toggleEmergencyContacts(t,e,n)}}});document.querySelectorAll('a, button, [tabindex]:not([tabindex="-1"])').forEach(e=>{e.addEventListener("focus",()=>{e.style.outline="3px solid var(--secondary)",e.style.outlineOffset="2px"}),e.addEventListener("blur",()=>{e.style.outline="",e.style.outlineOffset=""})})}toggleEmergencyContacts(e,t,n){const a=t.classList.contains("hidden");e.setAttribute("aria-expanded",!a),a?(t.style.display="block",t.style.opacity="0",t.style.transform="translateY(-20px)",setTimeout(()=>{t.classList.remove("hidden"),t.style.opacity="1",t.style.transform="translateY(0)",n.classList.remove("fa-chevron-down"),n.classList.add("fa-chevron-up"),e.style.borderRadius="20px 20px 0 0"},10)):(t.style.opacity="0",t.style.transform="translateY(-20px)",setTimeout(()=>{t.classList.add("hidden"),t.style.display="none",n.classList.remove("fa-chevron-up"),n.classList.add("fa-chevron-down"),e.style.borderRadius="20px"},300)),this.triggerHapticFeedback()}setupLinkEffects(e){const t=e.querySelector(".link-icon"),n=e.querySelector(".link-badge");e.addEventListener("mouseenter",()=>{this.add3DEffect(e),t&&(t.style.transform="scale(1.1) rotate(5deg) translateZ(20px)"),n&&(n.style.transform="scale(1.1) rotate(5deg)")}),e.addEventListener("mouseleave",()=>{this.remove3DEffect(e),t&&(t.style.transform="scale(1) rotate(0) translateZ(0)"),n&&(n.style.transform="scale(1) rotate(0)")}),e.addEventListener("mousedown",()=>{e.style.transform="translateY(-5px) scale(0.98)",this.triggerHapticFeedback()}),e.addEventListener("mouseup",()=>{e.style.transform="translateY(-12px) scale(1.02)"}),e.addEventListener("click",t=>{this.createRippleEffect(t,e)}),e.href&&e.href.startsWith("http")&&e.addEventListener("click",()=>{this.showLoading(e),setTimeout(()=>{this.hideLoading(e)},1e3)})}setupButtonEffects(e){e.addEventListener("mouseenter",()=>{this.add3DEffect(e)}),e.addEventListener("mouseleave",()=>{this.remove3DEffect(e)}),e.addEventListener("click",t=>{this.createRippleEffect(t,e),this.triggerHapticFeedback()})}setupSocialIconEffects(e){e.addEventListener("mouseenter",()=>{e.style.transform="scale(1.15) rotate(5deg) translateZ(10px)"}),e.addEventListener("mouseleave",()=>{e.style.transform="scale(1) rotate(0) translateZ(0)"}),e.addEventListener("click",()=>{this.triggerHapticFeedback()})}add3DEffect(e){e.style.transform="translateY(-12px) scale(1.02) rotateX(5deg)",e.style.boxShadow="0 20px 40px rgba(0, 0, 0, 0.15), 0 0 30px rgba(255, 215, 0, 0.3)"}remove3DEffect(e){e.style.transform="translateY(0) scale(1) rotateX(0)",e.style.boxShadow=""}createRippleEffect(e,t){const n=document.createElement("span"),a=t.getBoundingClientRect(),o=Math.max(a.width,a.height),s=e.clientX-a.left-o/2,i=e.clientY-a.top-o/2;n.style.cssText=`\n      position: absolute;\n      width: ${o}px;\n      height: ${o}px;\n      left: ${s}px;\n      top: ${i}px;\n      background: radial-gradient(circle, rgba(255, 255, 255, 0.7) 0%, transparent 70%);\n      border-radius: 50%;\n      transform: scale(0);\n      animation: ripple 0.6s linear;\n      pointer-events: none;\n      z-index: 1000;\n    `,t.style.position="relative",t.appendChild(n),setTimeout(()=>{n.remove()},600)}initializeAnimations(){const e=document.createElement("style");e.textContent="\n      @keyframes ripple {\n        to {\n          transform: scale(4);\n          opacity: 0;\n        }\n      }\n      \n      @keyframes float {\n        0%, 100% { transform: translateY(0px) rotate(0deg); }\n        25% { transform: translateY(-10px) rotate(1deg); }\n        50% { transform: translateY(-5px) rotate(0deg); }\n        75% { transform: translateY(-15px) rotate(-1deg); }\n      }\n      \n      @keyframes pulse {\n        0%, 100% { transform: scale(1); opacity: 1; }\n        50% { transform: scale(1.05); opacity: 0.8; }\n      }\n      \n      .particle {\n        position: fixed;\n        pointer-events: none;\n        z-index: -1;\n        animation: float 6s ease-in-out infinite;\n      }\n    ",document.head.appendChild(e)}createParticleBackground(){const e=document.querySelector(".app-container");if(!e)return;e.querySelectorAll(".particle").forEach(e=>e.remove());for(let t=0;t<120;t++){const t=document.createElement("div");t.className="particle";const n=Math.random()>.92,a=n?2.5*Math.random()+2.5:1.5*Math.random()+.7,o=100*Math.random(),s=100*Math.random(),i=["rgba(255,255,255,1)","rgba(255,255,255,0.85)","rgba(180,210,255,0.85)","rgba(180,210,255,1)"],r=i[Math.floor(Math.random()*i.length)];t.style.cssText=`\n        left: ${o}vw;\n        top: ${s}vh;\n        width: ${a}px;\n        height: ${a}px;\n        background: ${r};\n        opacity: 1;\n        border-radius: 50%;\n        box-shadow: 0 0 ${n?8*a:3*a}px ${r};\n        animation: ${n?"starTwinkleBig":"starTwinkle"} ${(8+8*Math.random()).toFixed(1)}s ease-in-out infinite;\n        animation-delay: ${(8*Math.random()).toFixed(1)}s;\n        position: fixed;\n        pointer-events: none;\n        z-index: 0;\n      `,e.appendChild(t)}}setupHapticFeedback(){CONFIG.enableHapticFeedback&&("vibrate"in navigator?this.triggerHapticFeedback=()=>{navigator.vibrate(10)}:this.triggerHapticFeedback=()=>{document.body.style.transform="scale(0.99)",setTimeout(()=>{document.body.style.transform="scale(1)"},50)})}initializePWA(){window.matchMedia("(display-mode: standalone)").matches&&(console.log("🚀 Executando como PWA instalado"),document.body.classList.add("pwa-mode")),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("service-worker.js").then(e=>{console.log("✅ Service Worker registrado:",e)}).catch(e=>{console.log("❌ Erro no Service Worker:",e)})}),window.addEventListener("online",()=>{this.showNotification("Conexão restaurada","success")}),window.addEventListener("offline",()=>{this.showNotification("Sem conexão com a internet","warning")})}showNotification(e,t="info"){const n=document.createElement("div");n.className=`notification notification-${t}`,n.textContent=e,n.style.cssText=`\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      padding: 15px 20px;\n      border-radius: 10px;\n      color: white;\n      font-weight: 500;\n      z-index: 10000;\n      transform: translateX(100%);\n      transition: transform 0.3s ease;\n      background: ${"success"===t?"#10b981":"warning"===t?"#f59e0b":"#3b82f6"};\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n    `,document.body.appendChild(n),setTimeout(()=>{n.style.transform="translateX(0)"},100),setTimeout(()=>{n.style.transform="translateX(100%)",setTimeout(()=>{n.remove()},300)},3e3)}showLoading(e){e.classList.add("loading")}hideLoading(e){e.classList.remove("loading")}showSuccess(e){e.style.background="linear-gradient(135deg, #10b981, #059669)",e.style.color="white",setTimeout(()=>{e.style.background="",e.style.color=""},1e3)}initInteractiveElements(){document.querySelectorAll(".app-link").forEach(e=>{this.setupLinkEffects(e)});const e=document.querySelector(".tutorial-btn");e&&(e.addEventListener("mouseenter",()=>{this.add3DEffect(e)}),e.addEventListener("mouseleave",()=>{this.remove3DEffect(e)}),e.addEventListener("click",t=>{this.createRippleEffect(t,e),this.triggerHapticFeedback()}));document.querySelectorAll(".social-icon").forEach(e=>{this.setupSocialIconEffects(e)})}}document.addEventListener("DOMContentLoaded",()=>{console.log("📄 DOM carregado, criando aplicação...");try{new ModernApp}catch(e){console.error("❌ Erro ao inicializar aplicação:",e);const t=document.getElementById("loading-screen");t&&setTimeout(()=>{t.classList.add("hidden"),setTimeout(()=>t.remove(),500)},1e3)}}),window.addEventListener("load",()=>{console.log("🌐 Página totalmente carregada");const e=document.getElementById("loading-screen");e&&!e.classList.contains("hidden")&&(console.log("⚠️ Loading screen ainda visível, removendo..."),setTimeout(()=>{e.classList.add("hidden"),setTimeout(()=>e.remove(),500)},500))}),window.addEventListener("load",()=>{const e=document.querySelectorAll("img[data-src]"),t=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.src=n.dataset.src,n.classList.remove("lazy"),t.unobserve(n)}})});e.forEach(e=>t.observe(e))});let lastTouchEnd=0;function isMobile(){return/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent)}document.addEventListener("touchend",e=>{const t=(new Date).getTime();t-lastTouchEnd<=300&&e.preventDefault(),lastTouchEnd=t},!1);let deferredPrompt=null;function showPwaInstallBtn(){if(!isMobile()||window.matchMedia("(display-mode: standalone)").matches)return;const e=document.getElementById("pwa-install-btn");e.innerHTML='\n    <button id="install-pwa-btn" style="\n      background: linear-gradient(135deg, #14305c 60%, #ffd700 100%);\n      color: #fff;\n      font-family: \'Exo 2\', \'Urbanist\', Arial, sans-serif;\n      font-weight: 700;\n      font-size: 1.1rem;\n      border: none;\n      border-radius: 32px;\n      padding: 16px 32px;\n      box-shadow: 0 8px 32px 0 rgba(20,48,92,0.22);\n      display: flex;\n      align-items: center;\n      gap: 14px;\n      cursor: pointer;\n      transition: box-shadow 0.3s, filter 0.3s, transform 0.3s;\n      animation: pwaBtnPop 0.7s cubic-bezier(0.4,0,0.2,1);\n    ">\n      <i class="fas fa-download" style="font-size:1.5em;color:#ffd700;"></i>\n      <span>Instalar o App</span>\n    </button>\n    <style>\n      @keyframes pwaBtnPop {\n        0% { transform: scale(0.7); opacity: 0; }\n        70% { transform: scale(1.1); opacity: 1; }\n        100% { transform: scale(1); }\n      }\n      #install-pwa-btn:hover {\n        filter: brightness(1.08);\n        box-shadow: 0 12px 40px 0 rgba(20,48,92,0.32);\n        transform: translateY(-2px) scale(1.04);\n      }\n    </style>\n  ',e.style.display="block",document.getElementById("install-pwa-btn").onclick=async()=>{if(deferredPrompt){deferredPrompt.prompt();const{outcome:e}=await deferredPrompt.userChoice;"accepted"===e&&hidePwaInstallBtn(),deferredPrompt=null}}}function hidePwaInstallBtn(){const e=document.getElementById("pwa-install-btn");e.style.display="none",e.innerHTML=""}window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),deferredPrompt=e,showPwaInstallBtn()}),window.addEventListener("appinstalled",()=>{hidePwaInstallBtn()}),window.matchMedia("(display-mode: standalone)").matches&&hidePwaInstallBtn();